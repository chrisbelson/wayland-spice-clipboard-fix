#!/bin/bash

export XDG_RUNTIME_DIR="/run/user/$(id -u)"
export WAYLAND_DISPLAY="wayland-0"
export DISPLAY=":0"

echo "Starting clipboard bridge"

last_clipboard=""

while true; do
    current_clipboard=$(wl-paste 2>/dev/null || true)
    
    if [ "$current_clipboard" != "$last_clipboard" ] && [ -n "$current_clipboard" ]; then
        echo "$current_clipboard" | xclip -selection clipboard -i 2>/dev/null
        echo "Clipboard updated: $(echo "$current_clipboard" | wc -c) chars"
        last_clipboard="$current_clipboard"
    fi
    
    sleep 1
done
